# 业务场景
移动业务，附近的人，计算距离并按距离排序，能显示每个人所在省市区信息，能显示每个人的行动轨迹。

# 遇到的问题
- 未开启定位时，无法获取经纬度
- 如何储存经纬度并能方便计算

# 业务说明
- 获取经纬度方法：
1. 定位 
2. GeoIP定位 
3. 基站位置数据 
4. 全国WIFI热点位置数据。
- 经纬度储存方式：
1. redis的Geo命令，要求redis > v3.2时 
2. MongoDB，专门针对这种查询建立了地理空间索引 
3. MySQL版本大于等于5.7时，innoDB引擎有geometry类型，同时增加很多通用的GIS函数 
4. PostgreSQL+postgis空间查询、空间计算等功能丰富，空间索引页更加完善，专业做GIS数据库可选这个

# 其他
- 经纬度在数据库中如何存储？答：一般支持GIS的数据库都有geometry类型等类型，如果单独储存经纬度可以用 decimal 类型，推荐decimal(10,6)，精度大概为0.11米

# 演示

对于一般APP应用来说，使用redis的geo实时计算附近的人，用MySQL的geometry类型持久化，是一个不错的选择。

## 当没开启定位或获取不到定位时，通过接口请求位置信息。一般通过GeoIP、基站、热点等混合定位。

## 上报经纬度时，首先更新redis中的经纬度。


[如何高效存储海量GPS数据][1]



  [1]: https://yq.aliyun.com/articles/74460